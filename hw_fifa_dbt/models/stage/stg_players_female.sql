{{ config(
    materialized='table',
    tags=['stage', 'players', 'female']
) }}


WITH raw_data AS (
    SELECT *
    FROM {{ ref('female_players') }}
),

cleaned_data AS (
    SELECT
        CAST(player_id AS BIGINT) AS player_id,
        player_url AS player_url,
        CAST(fifa_version AS INT) AS fifa_version,
        CAST(fifa_update AS INT) AS fifa_update,
        CAST(fifa_update_date AS DATE) AS fifa_update_date,
        short_name AS short_name,
        long_name AS long_name,
        player_positions AS player_positions,
        CAST(overall AS INT) AS overall,
        CAST(potential AS INT) AS potential,
        CAST(value_eur AS BIGINT) AS value_eur,
        CAST(wage_eur AS BIGINT) AS wage_eur,
        CAST(age AS INT) AS age,
        CAST(dob AS DATE) AS date_of_birth,
        CAST(height_cm AS INT) AS height_cm,
        CAST(weight_kg AS INT) AS weight_kg,
        CAST(league_id AS INT) AS league_id,
        league_name AS league_name,
        CAST(league_level AS INT) AS league_level,
        CAST(club_team_id AS BIGINT) AS club_team_id,
        club_name AS club_name,
        club_position AS club_position,
        CAST(club_jersey_number AS INT) AS club_jersey_number,
        club_loaned_from AS club_loaned_from,
        CAST(club_joined_date AS DATE) AS club_joined_date,
        CAST(club_contract_valid_until_year AS INT) AS club_contract_valid_until_year,
        CAST(nationality_id AS INT) AS nationality_id,
        nationality_name AS nationality_name,
        CAST(nation_team_id AS BIGINT) AS nation_team_id,
        nation_position AS nation_position,
        CAST(nation_jersey_number AS INT) AS nation_jersey_number,
        preferred_foot AS preferred_foot,
        CAST(weak_foot AS INT) AS weak_foot,
        CAST(skill_moves AS INT) AS skill_moves,
        CAST(international_reputation AS INT) AS international_reputation,
        work_rate AS work_rate,
        body_type AS body_type,
        real_face AS real_face,
        CAST(release_clause_eur AS BIGINT) AS release_clause_eur,
        player_tags AS player_tags,
        player_traits AS player_traits,
        CAST(pace AS INT) AS pace,
        CAST(shooting AS INT) AS shooting,
        CAST(passing AS INT) AS passing,
        CAST(dribbling AS INT) AS dribbling,
        CAST(defending AS INT) AS defending,
        CAST(physic AS INT) AS physic,
        CAST(attacking_crossing AS INT) AS attacking_crossing,
        CAST(attacking_finishing AS INT) AS attacking_finishing,
        CAST(attacking_heading_accuracy AS INT) AS attacking_heading_accuracy,
        CAST(attacking_short_passing AS INT) AS attacking_short_passing,
        CAST(attacking_volleys AS INT) AS attacking_volleys,
        CAST(skill_dribbling AS INT) AS skill_dribbling,
        CAST(skill_curve AS INT) AS skill_curve,
        CAST(skill_fk_accuracy AS INT) AS skill_fk_accuracy,
        CAST(skill_long_passing AS INT) AS skill_long_passing,
        CAST(skill_ball_control AS INT) AS skill_ball_control,
        CAST(movement_acceleration AS INT) AS movement_acceleration,
        CAST(movement_sprint_speed AS INT) AS movement_sprint_speed,
        CAST(movement_agility AS INT) AS movement_agility,
        CAST(movement_reactions AS INT) AS movement_reactions,
        CAST(movement_balance AS INT) AS movement_balance,
        CAST(power_shot_power AS INT) AS power_shot_power,
        CAST(power_jumping AS INT) AS power_jumping,
        CAST(power_stamina AS INT) AS power_stamina,
        CAST(power_strength AS INT) AS power_strength,
        CAST(power_long_shots AS INT) AS power_long_shots,
        CAST(mentality_aggression AS INT) AS mentality_aggression,
        CAST(mentality_interceptions AS INT) AS mentality_interceptions,
        CAST(mentality_positioning AS INT) AS mentality_positioning,
        CAST(mentality_vision AS INT) AS mentality_vision,
        CAST(mentality_penalties AS INT) AS mentality_penalties,
        CAST(mentality_composure AS INT) AS mentality_composure,
        CAST(defending_marking_awareness AS INT) AS defending_marking_awareness,
        CAST(defending_standing_tackle AS INT) AS defending_standing_tackle,
        CAST(defending_sliding_tackle AS INT) AS defending_sliding_tackle,
        CAST(goalkeeping_diving AS INT) AS goalkeeping_diving,
        CAST(goalkeeping_handling AS INT) AS goalkeeping_handling,
        CAST(goalkeeping_kicking AS INT) AS goalkeeping_kicking,
        CAST(goalkeeping_positioning AS INT) AS goalkeeping_positioning,
        CAST(goalkeeping_reflexes AS INT) AS goalkeeping_reflexes,
        CAST(goalkeeping_speed AS INT) AS goalkeeping_speed,
        ls AS ls,
        st AS st,
        rs AS rs,
        lw AS lw,
        lf AS lf,
        cf AS cf,
        rf AS rf,
        rw AS rw,
        lam AS lam,
        cam AS cam,
        ram AS ram,
        lm AS lm,
        lcm AS lcm,
        cm AS cm,
        rcm AS rcm,
        rm AS rm,
        lwb AS lwb,
        ldm AS ldm,
        cdm AS cdm,
        rdm AS rdm,
        rwb AS rwb,
        lb AS lb,
        lcb AS lcb,
        cb AS cb,
        rcb AS rcb,
        rb AS rb,
        gk AS gk,
        player_face_url AS player_face_url
    FROM raw_data
    WHERE player_id IS NOT NULL
    AND player_url IS NOT NULL
    AND short_name IS NOT NULL
    AND dob > '1900-01-01'
)

SELECT *
FROM cleaned_data;